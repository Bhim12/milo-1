{
  "version": 3,
  "sources": ["../src/merch-subscription-panel.js", "../src/constants.js", "../src/utils.js", "../src/async-control.js", "../src/commerce-aware.js", "../src/merch-secure-transaction.js", "../src/merch-secure-transaction.css.js", "../src/merch-subscription-panel.css.js"],
  "sourcesContent": ["import { LitElement, html, nothing } from 'lit';\n\nimport { CommerceAware } from './commerce-aware.js';\nimport { CLASS_NAME_HIDDEN } from './constants.js';\nimport './merch-secure-transaction.js';\nimport { isRegularPrice, showOffers } from './utils.js';\n\nimport { styles } from './merch-subscription-panel.css.js';\n\nexport const SLOT_COMMITMENT = 'commitment';\nexport const SLOT_CONDITION = 'condition';\nexport const SLOT_CONDITION_TOOLTIP = 'condition-tooltip';\nexport const SLOT_FOOTER = 'footer';\nexport const SLOT_HEADER = 'header';\nexport const SLOT_OFFER = 'offer';\nexport const SLOT_STOCK = 'stock';\n\nexport const OFFER_SLOTS = [\n    SLOT_COMMITMENT,\n    SLOT_CONDITION,\n    SLOT_CONDITION_TOOLTIP,\n];\n\n/**\n * Update of these properties transfers panel to the \"pending\" state\n */\nconst REACTIONS = ['card', 'checkout', 'commerce', 'offers', 'selected'];\n\nexport const TAG_NAME = 'merch-subscription-panel';\nexport const TAG_NAME_STOCK = 'merch-stock';\n\nexport class SubscriptionPanel extends CommerceAware(LitElement, TAG_NAME) {\n    /**\n     * Helps to track exact paanel activation monent.\n     * It requires many factors to meet:\n     *  - commerce servce is active,\n     *  - checkout CTA is provided by the parent,\n     *  - some `merch-card` is found and connected,\n     *  - card prices are grouped into offers,\n     *  - global `merch-stock` element is found and connected.\n     */\n    #active = false;\n    /**\n     * Reference to a `merch-card` element, currently connected to this panel.\n     * @type { Element | undefined}\n     */\n    #card;\n    /**\n     * Checkout link is expected to be provided by the consumer.\n     * When provided, this component starts to control it by updating its href for a selected offer.\n     * @type {Commerce.Checkout.Placeholder | undefined}\n     */\n    #checkout;\n    /** @type {import('./merch-stock.js').Stock | undefined} */\n    #stock;\n    /**\n     * The stock element discovered at the moment of activation, if any.\n     * @type {boolean}\n     */\n    #stockSelected;\n\n    /**\n     * Updates checkout CTA with the data of the selected offer\n     * so the click on the link will navigate the user to the correct checkout page.\n     */\n    async #updateCheckout() {\n        const { checkout, selected } = this;\n        if (!checkout) return;\n        checkout.classList.toggle(CLASS_NAME_HIDDEN, !selected);\n        if (!selected) return;\n        const { options } = selected.inlinePrices.find(isRegularPrice);\n        if (this.#stockSelected) {\n            const stock = this.#stock;\n            await stock.resolveComplete;\n            const regularPrice =\n                stock.selected.inlinePrices.find(isRegularPrice);\n            checkout.updateOptions({\n                ...options,\n                wcsOsi: options.wcsOsi.concat(\n                    regularPrice?.options?.wcsOsi ?? []\n                ),\n            });\n        } else {\n            checkout.updateOptions(options);\n        }\n        this.control.resolve(checkout.onceSettled());\n    }\n\n    /**\n     * Reacts to change of selection and updates offer radios and card prices.\n     */\n    #updateSelected() {\n        const { selected } = this;\n        if (selected) {\n            const radio = this.shadowRoot.getElementById(selected.planType);\n            radio.checked = true;\n            /** @type {import('./merch-stock.js').Stock} */\n            const stock = this.getElementsByTagName(TAG_NAME_STOCK)[0];\n            if (stock) stock.selected = selected;\n            showOffers(this.offers, (offer) => offer === selected);\n        } else {\n            this.selected = this.offers?.values().next().value;\n        }\n    }\n\n    /**\n     * Reacts to update of offers collection and updates slots for offer literals with the provided content:\n     * - commitment text,\n     * - condition text,\n     * - condition tooltip.\n     */\n    #updateOffers() {\n        const { offers } = this;\n        if (!offers) {\n            this.selected = undefined;\n            return;\n        }\n        this.selected = this.offers.values().next().value;\n        showOffers(offers, (_, index) => index === 0);\n        for (const offer of offers.values()) {\n            /** @type {HTMLTemplateElement} */\n            const template = this.querySelector(\n                `template[name=\"${offer.planType}\"]`\n            );\n            if (template) {\n                OFFER_SLOTS.forEach((slotName) => {\n                    this.#updateSlot(\n                        `${offer.planType}-${slotName}`,\n                        template.content.querySelectorAll(\n                            `[slot=\"${slotName}\"]`\n                        ),\n                        true\n                    );\n                });\n            }\n            const container = offer.container?.cloneNode(true);\n            if (!container) continue;\n            container.classList.remove(CLASS_NAME_HIDDEN);\n            this.#updateSlot(`${offer.planType}-${SLOT_OFFER}`, [container]);\n        }\n    }\n\n    /**\n     * Updates given slot by its `name` by assigning given `elements` to it.\n     * @param { string } name\n     * @param { NodeList | Element[] } elements\n     * @param { boolean } clone\n     * If set to `true`, clones the `elements` before appending them.\n     */\n    #updateSlot(name, elements, clone = false) {\n        this.querySelectorAll(`[slot=\"${name}\"]`).forEach((element) =>\n            element.remove()\n        );\n        elements.forEach((element) => {\n            if (clone) element = element.cloneNode(true);\n            element.slot = name;\n            this.appendChild(element);\n        });\n    }\n\n    /**\n     * Returns card component, currently connected to this panel.\n     */\n    get card() {\n        return this.#card;\n    }\n\n    /**\n     * Connects given card component to this panel.\n     */\n    set card(card) {\n        if (this.#card === card) return;\n        this.#card = card;\n        this.offers?.clear();\n        this.selected = undefined;\n        if (!card) return;\n        this.log.debug('Bound to card:', { card, element: this });\n        this.discoverOffers(card);\n    }\n\n    /**\n     * Returns checkout CTA component, controlled by this panel.\n     */\n    get checkout() {\n        return this.#checkout;\n    }\n\n    /**\n     * Returns currently selected stock offer.\n     */\n    get stock() {\n        return this.#stockSelected ? this.#stock : undefined;\n    }\n\n    /**\n     * Selects or deselects stock offer.\n     * @param {boolean} value\n     */\n    set stock(value) {\n        this.#stockSelected = !!value;\n    }\n\n    /**\n     * Renders list of selectable offers,\n     * based on the placeholders and related content found of the connected card.\n     */\n    get offersSection() {\n        const offers = [];\n        for (const { planType } of this.offers.values()) {\n            if (!this.querySelector(`template[name=\"${planType}\"]`)) continue;\n            const onInputChange = () => {\n                this.selected = planType;\n            };\n            const offer = html`<div>\n                <input\n                    autocomplete=\"off\"\n                    ?checked=\"${this.selected?.planType === planType}\"\n                    @change=\"${onInputChange}\"\n                    id=\"${planType}\"\n                    name=\"offer\"\n                    type=\"radio\"\n                    value=\"${planType}\"\n                />\n                <label for=\"${planType}\">\n                    <slot name=\"${planType}-${SLOT_COMMITMENT}\"></slot>\n                    <slot name=\"${planType}-${SLOT_OFFER}\"></slot>\n                    <slot name=\"${planType}-${SLOT_CONDITION}\"></slot>\n                    <overlay-trigger placement=\"top\" offset=\"4\">\n                        <span class=\"condition-icon\" slot=\"trigger\"></span>\n                        <sp-tooltip slot=\"hover-content\" delayed\n                            ><slot\n                                name=\"${planType}-${SLOT_CONDITION_TOOLTIP}\"\n                            ></slot\n                        ></sp-tooltip>\n                    </overlay-trigger>\n                </label>\n            </div> `;\n            offers.push(offer);\n        }\n        return offers;\n    }\n\n    /**\n     * Renderes stock checkbox and label if `merch-stock` component is found in the DOM.\n     */\n    get stockSection() {\n        /** @type {import('./merch-stock.js').Stock} */\n        const stock = this.#stock;\n        // Stock offers can be filtered out if this panel itself currently displays stocks\n        if (!stock?.offers.size) return nothing;\n        const onStockClick = () => {\n            const old = this.stock;\n            this.stock = !old;\n            this.log.debug('Stock:', { stock: this.stock, element: this });\n            this.requestUpdate('stock', old);\n        };\n        return html`<sp-field-group>\n            <sp-checkbox\n                ?checked=${!!this.#stockSelected}\n                size=\"m\"\n                @click=${onStockClick}\n            >\n                <slot name=\"${SLOT_STOCK}\"></slot>\n            </sp-checkbox>\n        </sp-field-group>`;\n    }\n\n    /**\n     * Renders subscription layout when connected to a card and has prices.\n     */\n    get listLayout() {\n        const onFooterSlotChange = () => {\n            /** @type { Commerce.Checkout.Placeholder } */\n            /** @type { HTMLSlotElement } */\n            const slot = this.shadowRoot.querySelector(\n                `slot[name=\"${SLOT_FOOTER}\"]`\n            );\n            if (slot) {\n                const checkout = slot\n                    .assignedElements({ flatten: true })\n                    .filter((element) => element.isCheckoutLink)[0];\n                if (this.#checkout !== checkout) {\n                    this.#checkout = checkout;\n                    this.requestUpdate('checkout');\n                }\n            }\n        };\n        return html`\n            <sp-theme theme=\"spectrum\" color=\"light\" scale=\"medium\">\n                <div id=\"panel\">\n                    <div id=\"header\">\n                        <slot name=\"${SLOT_HEADER}\"></slot>\n                    </div>\n                    <div id=\"plans\">${this.offersSection}</div>\n                    <div id=\"stock\">${this.stockSection}</div>\n                    <div id=\"footer\">\n                        <slot\n                            name=\"${SLOT_FOOTER}\"\n                            @slotchange=${onFooterSlotChange}\n                        ></slot>\n                    </div>\n                </div>\n            </sp-theme>\n        `;\n    }\n\n    /**\n     * Renders loading spinner when disconnected from a card or waits for prices to resolve.\n     */\n    get waitLayout() {\n        return html`\n            <sp-theme theme=\"spectrum\" color=\"light\" scale=\"medium\">\n                <div id=\"spinner\">\n                    <sp-progress-circle indeterminate size=\"l\" />\n                </div>\n            </sp-theme>\n        `;\n    }\n\n    /**\n     * @param {Commerce.Offer} offer\n     */\n    filterOffer(offer) {\n        return offer.inlinePrices.some(isRegularPrice);\n    }\n\n    render() {\n        return this.card && this.offers ? this.listLayout : this.waitLayout;\n    }\n\n    /**\n     * Reacts to updates of this component.\n     * @param {Map<string, any>} changed\n     */\n    updated(changed) {\n        const element = this;\n        const { card, checkout, commerce, log, offers } = this;\n        // Log what was updated\n        if (\n            changed.has('card') ||\n            changed.has('checkout') ||\n            changed.has('commerce') ||\n            changed.has('offers')\n        ) {\n            /* c8 ignore start */\n            if (card && checkout && commerce && offers && !this.#active) {\n                /** @type {import('./merch-stock.js').Stock} */\n                const stock = document\n                    .querySelector(TAG_NAME_STOCK)\n                    ?.cloneNode(true);\n                if (stock) {\n                    stock.selected = this.selected;\n                    this.#stock = stock;\n                }\n                this.#updateSlot(SLOT_STOCK, [stock]);\n                this.#active = true;\n                log.debug('Activated:', {\n                    card,\n                    offers,\n                    checkout,\n                    element,\n                    stock,\n                });\n            } else {\n                // Note: Lazy logging pattern\n                // The costly computing of changed props will only run if debug logs are not filtered out by env config\n                log?.debug('Updated:', () => ({\n                    ...Object.fromEntries(\n                        [...changed.entries()].map(([key, old]) => [\n                            key,\n                            { new: this[key], old },\n                        ])\n                    ),\n                    element,\n                }));\n            }\n            /* c8 ignore stop */\n            if (this.#active && !(card && checkout && offers)) {\n                this.#active = false;\n            }\n        }\n        // Updated offers collection\n        if (changed.has('offers')) {\n            this.#updateOffers();\n        }\n        // Updated offer selection\n        if (changed.has('selected')) {\n            this.#updateSelected();\n            this.#updateCheckout();\n        }\n        // Updated checkout CTA in the footer slot\n        if (changed.has('checkout') || changed.has('stock')) {\n            this.#updateCheckout();\n        }\n    }\n\n    requestUpdate(name, ...args) {\n        super.requestUpdate(name, ...args);\n        if (this.isUpdatePending && REACTIONS.includes(name))\n            // Any update to any custom reactive property transfers this component to the pending state\n            // so to perform discovery and async resolution of placeholders from the bound card,\n            // stock offers from the document nearby, group everything and render\n            this.control.init();\n    }\n\n    static styles = [styles];\n}\n\nwindow.customElements.define(TAG_NAME, SubscriptionPanel);\n", "/**\n * Common namespace prefix for CSS classes and DOM event types.\n * @see https://git.corp.adobe.com/wcms/team/discussions/27\n */\nexport const NAMESPACE = 'merch';\n/**\n * This CSS class name is used to:\n * - show only selected offer on a card connected to a subscription panel\n * - TBD\n */\nexport const CLASS_NAME_HIDDEN = 'hidden';\n/**\n * Event type dispatched by the commenrce service whenever it is ready.\n * Should be in sync with `packages/commerce/src/constants.js`.\n */\nexport const EVENT_TYPE_READY = 'wcms:commerce:ready';\n/**\n * Tag name of the commerce service component.\n * Should be in sync with `packages/commerce/src/constants.js`.\n */\nexport const TAG_NAME_SERVICE = 'wcms-commerce';\n", "import { CLASS_NAME_HIDDEN, NAMESPACE } from './constants.js';\n\nexport function debounce(func, delay) {\n    let debounceTimer;\n    return function () {\n        const context = this;\n        const args = arguments;\n        clearTimeout(debounceTimer);\n        debounceTimer = setTimeout(() => func.apply(context, args), delay);\n    };\n}\n\nexport const getSlotText = (element, name) =>\n    element.querySelector(`[slot=\"${name}\"]`).textContent.trim();\n\n/**\n * Dispatches custom event of the given `type` on the given `target`.\n * @template T\n * @param {EventTarget} target\n * @param {string} type\n * @param {CustomEventInit<T>} options\n */\nexport const dispatchAsyncEvent = (\n    target,\n    type,\n    { bubbles = true, cancelable, composed, detail } = {}\n) =>\n    window.setTimeout(() =>\n        target?.dispatchEvent(\n            new CustomEvent(type, {\n                bubbles,\n                cancelable,\n                composed,\n                detail,\n            })\n        )\n    );\n\n/**\n * Finds the closest common ancestor for given array of DOM elements.\n * Note: the search may go up DOM tree beyoud some expected container (e.g. card) and event result in `document.body`.\n * For a good solution, @see https://developer.mozilla.org/en-US/docs/Web/API/Node/compareDocumentPosition\n * @param { Element[] } elements\n * Array of DOM elements to find the common ancestor for.\n * @returns { Element | null }\n * The closest common ancestor of the given elements or `null` if none found.\n */\nexport function getCommonAncestor(...elements) {\n    const [first, ...rest] = elements;\n    if (!first) return null;\n    let ancestor = first.parentElement;\n    if (!rest.length) return ancestor;\n    while (ancestor) {\n        if (rest.every((element) => ancestor.contains(element))) {\n            return ancestor;\n        }\n        ancestor = ancestor.parentElement;\n    }\n    return null;\n}\n\n/**\n * @param {Commerce.Placeholder} placeholder\n * @returns {boolean}\n */\nexport function isRegularPrice(placeholder) {\n    if (placeholder.isInlinePrice) {\n        const { template } = placeholder.dataset;\n        if (template === 'price' || !template) {\n            return true;\n        }\n    }\n    return false;\n}\n\n/**\n * Joins an array of string `tokens`,\n * filtering out `falsy` values and replacing non-word characters in each token.\n * @param { string[] } tokens\n * Array of strings to be joined.\n * @param { string } delimiter\n * Delimiter used to join the tokens and replace non-word characters.\n */\nconst joinTokens = (tokens, delimiter) =>\n    tokens\n        .filter((token) => token)\n        .map((token) => token.replace(/\\W+/g, delimiter))\n        .join(delimiter);\n\n/**\n * Creates a namespaced CSS class name.\n * Replaces any sequence of non-word characters with a single hyphen.\n * @param {...string} args - Components of the class name.\n * @returns {string} - The namespaced and cleaned CSS class name.\n */\nexport const makeCssClassName = (...args) =>\n    `${NAMESPACE}-${joinTokens(args, '-')}`;\n\n/**\n * Creates a namespaced event type.\n * Replaces any sequence of non-word characters with a single colon.\n * @param {...string} args - Components of the event type.\n * @returns {string} The namespaced and cleaned event type.\n */\nexport const makeEventTypeName = (...args) =>\n    `${NAMESPACE}:${joinTokens(args, ':')}`;\n\n/**\n * Returns a function dispatching custom event of the given `type` on the given `target`.\n * @template T\n * @param {EventTarget} target\n * @param {string} type\n * @param {CustomEventInit<T>} options\n * @returns {(options: CustomEventInit<T>) => void}\n */\nexport function makeAsyncEventDispatch(\n    target,\n    type,\n    { bubbles = true, cancelable, composed } = {}\n) {\n    return (options = {}) =>\n        dispatchAsyncEvent(target, type, {\n            bubbles,\n            cancelable,\n            composed,\n            ...options,\n        });\n}\n\n/**\n * @param {Commerce.Offers} offers\n * @param {Commerce.filterOffer} filter\n */\nexport function showOffers(offers, filter = () => true) {\n    let i = 0;\n    for (const offer of offers.values()) {\n        offer.container?.classList.toggle(\n            CLASS_NAME_HIDDEN,\n            !filter(offer, i++)\n        );\n    }\n}\n", "import {\n    dispatchAsyncEvent,\n    makeCssClassName,\n    makeEventTypeName,\n} from './utils.js';\n\nconst FAILED = 'failed';\nconst PENDING = 'pending';\nconst RESOLVED = 'resolved';\n\n/**\n * Notifies observing modules about results of an asynchronous operation that\n * can be reccurently performed by a component from time to time.\n * Basically, any async component can be in one of three states:\n * - `pending` - the component is waiting for the async operation to complete;\n * - `resolved` - the async operation has completed successfully;\n * - `failed` - the async operation has failed.\n * This helper toggles state reflecting css classes and emits state events.\n */\nexport class AsyncControl {\n    /** @type {Error | undefined} */\n    #error;\n    /**\n     * @type {{\n     *  cssClassNames?: Record<string, string>;\n     *  eventOptions?: EventInit;\n     *  eventTypeNames?: Record<string, string>;\n     * }}\n     */\n    #options = {};\n    /** @type {string} */\n    #state;\n    #target;\n\n    /**\n     * Creates a new instance of control, pending for resolution.\n     * @param {Element} target\n     * @param {{\n     *  cssPrefix?: string;\n     *  eventOptions?: EventInit;\n     *  eventPrefix?: string;\n     * }} options\n     */\n    constructor(\n        target,\n        {\n            cssPrefix = 'component',\n            eventOptions,\n            eventPrefix = 'component',\n        } = {}\n    ) {\n        this.#target = target;\n        const options = this.#options;\n        options.cssClassNames = {};\n        options.eventOptions = eventOptions;\n        options.eventTypeNames = {};\n        for (const state of [FAILED, PENDING, RESOLVED]) {\n            options.cssClassNames[state] = makeCssClassName(cssPrefix, state);\n            options.eventTypeNames[state] = makeEventTypeName(\n                eventPrefix,\n                state\n            );\n        }\n        this.init();\n    }\n\n    #notify(detail) {\n        const { cssClassNames, eventOptions, eventTypeNames } = this.#options;\n        [FAILED, PENDING, RESOLVED].forEach((state) => {\n            this.#target.classList.toggle(\n                cssClassNames[state],\n                state === this.#state\n            );\n        });\n        dispatchAsyncEvent(this.#target, eventTypeNames[this.#state], {\n            ...eventOptions,\n            detail,\n        });\n    }\n\n    /**\n     * Gets the latest rejection error.\n     * @returns {Error | undefined}\n     */\n    get error() {\n        return this.#error;\n    }\n\n    /**\n     * Returns the promise pending for completion of the currently active async operation.\n     * If no operation is active at the moment, it returns a settled promise.\n     * @returns {Promise}\n     */\n    get promise() {\n        return new Promise((resolve, reject) => {\n            this.subscribe(resolve, reject);\n        });\n    }\n\n    /**\n     * Returns the current state of the object.\n     * @returns {string}\n     */\n    get state() {\n        return this.#state;\n    }\n\n    /**\n     * Signals start of a new asynchronous operation and returns.\n     * Returns `false` if object was already in pending state.\n     */\n    init() {\n        if (this.#state !== PENDING) {\n            this.#state = PENDING;\n            this.#error = undefined;\n            this.#notify();\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Signals the success of the asynchronous operation and stores its `value`\n     * given that the caller provides the `secret` matching the latest made.\n     * @param {Error} error\n     * True if the `secret` has matched and control was resolved.\n     */\n    reject(error) {\n        if (this.#state !== PENDING) return false;\n        this.#error = error;\n        this.#state = FAILED;\n        this.#notify();\n        return true;\n    }\n\n    /**\n     * Signals the success of the asynchronous operation and stores its `value`\n     * given that the caller provides the `secret` matching the latest made.\n     * @param {Promise<any>} [promise]\n     * True if the `secret` has matched and control was resolved.\n     */\n    async resolve(promise) {\n        if (this.#state !== PENDING) return false;\n        if (promise) await promise;\n        this.#state = RESOLVED;\n        this.#notify();\n        return true;\n    }\n\n    subscribe(resolved, failed, once) {\n        const { eventTypeNames } = this.#options;\n        const target = this.#target;\n        let triggered = false;\n        const onFailed = (event) => {\n            if (once && triggered) return;\n            triggered = true;\n            failed(event.detail);\n        };\n        const onResolved = (event) => {\n            if (once && triggered) return;\n            triggered = true;\n            resolved(event.detail);\n        };\n        const state = this.#state;\n        if (FAILED === state) failed?.(this.#error);\n        else if (RESOLVED === state) resolved(this.#target);\n        if (triggered) return () => {};\n        const options = once ? { once: true } : undefined;\n        target.addEventListener(eventTypeNames[RESOLVED], onResolved, options);\n        if (failed) {\n            target.addEventListener(eventTypeNames[FAILED], onFailed, options);\n        }\n        return () => {\n            target.removeEventListener(eventTypeNames[RESOLVED], onResolved);\n            if (failed) {\n                target.removeEventListener(eventTypeNames[FAILED], onFailed);\n            }\n        };\n    }\n\n    static FAILED = FAILED;\n    static PENDING = PENDING;\n    static RESOLVED = RESOLVED;\n}\n", "import { AsyncControl } from './async-control.js';\nimport { EVENT_TYPE_READY, TAG_NAME_SERVICE } from './constants.js';\nimport { getCommonAncestor } from './utils.js';\n\nexport const UNKNOWN_PLAN_TYPE = 'UNKNOWN';\n\n/**\n * Groups provided commerce placeholders into offers.\n * @param {Commerce.Placeholder[]} placeholders\n * @param {Element} container\n * @param {{\n *  filterOffer?: Commerce.filterOffer;\n *  filterPlaceholder?: Commerce.filterPlaceholder;\n * }} filters\n */\nasync function makeOffers(container, filters, placeholders) {\n    /** @type {Commerce.Offers} */\n    const offers = new Map();\n    // Note: all placeholders are awaited in parallel\n    await Promise.allSettled(\n        placeholders.map((placeholder) => placeholder.onceSettled())\n    );\n    let i = 0;\n    for (const placeholder of placeholders) {\n        if (!filters.filterPlaceholder(placeholder, i++)) continue;\n        const wcsOffers = placeholder?.value ?? [];\n        // Note: `UNKNOWN_PLAN_TYPE` - special group for failed commerce placeholders, perhaps should be ignored in render\n        for (const { planType = UNKNOWN_PLAN_TYPE } of wcsOffers) {\n            // Use group for this plan type, create if needed\n            const group = offers.get(planType) ?? {\n                checkoutLinks: [],\n                inlinePrices: [],\n                planType,\n                get container() {\n                    const candidate = getCommonAncestor(\n                        ...group.checkoutLinks,\n                        ...group.inlinePrices\n                    );\n                    if (\n                        candidate?.compareDocumentPosition(container) &\n                        Node.DOCUMENT_POSITION_CONTAINS\n                    ) {\n                        return candidate;\n                    }\n                    return undefined;\n                },\n            };\n            // Classify placeholder\n            if (placeholder.isCheckoutLink) {\n                group.checkoutLinks.push(placeholder);\n            } else if (placeholder.isInlinePrice) {\n                group.inlinePrices.push(placeholder);\n            }\n            offers.set(planType, group);\n        }\n    }\n    i = 0;\n    for (const offer of offers.values()) {\n        if (!filters.filterOffer(offer, i++)) {\n            offers.delete(offer.planType);\n        }\n    }\n    return offers;\n}\n\n/**\n * Notifies the provided `callback` every time the commerce service is initialised,\n * providing currently active instance of the service.\n * @param {(commerce: Commerce.Instance) => void} callback\n * @param {{ once?: boolean; }} options\n * @returns {() => void}\n * A function, stopping notifications when called.\n */\nexport function discoverService(callback, { once = false } = {}) {\n    const { head } = document;\n    let latest = null;\n    function discover() {\n        /** @type { Commerce.Instance } */\n        const current = head.querySelector(TAG_NAME_SERVICE);\n        if (current === latest) return;\n        latest = current;\n        if (current) callback(current);\n    }\n    head.addEventListener(EVENT_TYPE_READY, discover, { once });\n    window.setTimeout(discover);\n    return () => head.removeEventListener(EVENT_TYPE_READY, discover);\n}\n\n/**\n * Lit mixin for web components requiring active instance of the commerce service.\n * Creates `commerce`, `log` and `offers` properties on the enhanced component.\n * @param {Commerce.ComponentConstructor} Component\n * @param {string} name\n * @example\n * class MyElement extends CommerceAware(LitElement, 'my-element') {}\n */\nexport function CommerceAware(Component, name) {\n    // TODO: `name` arg can be replaced with a call to `CustomElementRegistry.getName` method in the future\n    // SEE: https://caniuse.com/mdn-api_customelementregistry_getname\n    return class CommerceAware extends Component {\n        /**\n         * Notifies connected components about state changes.\n         */\n        #control = new AsyncControl(this, {\n            cssPrefix: name,\n            eventPrefix: name,\n        });\n        /** @type {Commerce.Instance | undefined} */\n        #commerce;\n        /** @type {() => void} */\n        #dispose;\n        /** @type {Commerce.Log.Instance | undefined} */\n        #log;\n        /** @type {Commerce.Offers | undefined} */\n        #offers;\n        /**\n         * Preselected offer type, if any.\n         * Stored in case if offers are still pending but selection is already requested.\n         * @type { any }\n         */\n        #preselected;\n        /**\n         * The currently selected offer, if any.\n         * @type { Commerce.Offer | undefined }\n         */\n        #selected;\n\n        /**\n         * @param { string | Commerce.Offer } value\n         */\n        #updateSelected(value) {\n            const { offers } = this;\n            if (!offers) return;\n            const selected = offers.get(value) ?? offers.get(value?.planType);\n            if (selected === this.#selected) return;\n            const old = this.#selected;\n            this.#selected = selected;\n            this.requestUpdate('selected', old);\n            /* c8 ignore start */\n            this.log?.debug('Selected:', {\n                selected: this.selected?.planType,\n                element: this,\n            });\n            /* c8 ignore stop */\n        }\n\n        get commerce() {\n            return this.#commerce;\n        }\n\n        get control() {\n            return this.#control;\n        }\n\n        get log() {\n            return this.#log;\n        }\n\n        get offers() {\n            return this.#offers;\n        }\n\n        /**\n         * Returns a promise resolving when this panel has all data to render the offers,\n         * or rejecting with the error occured during offer resolution.\n         */\n        get resolveComplete() {\n            return this.#control.promise;\n        }\n\n        /**\n         * Returns the currently selected selected offer, if any.\n         * @returns { Commerce.Offer | undefined }\n         */\n        get selected() {\n            return this.#selected;\n        }\n\n        /**\n         * Allows programmatic control of the selected offer.\n         * Accepts plan type as string or offer object (and uses its pla type to select among own offers).\n         * If given plan type cannot be found, selects first offer in the document order.\n         * @param { string | Commerce.Offer } value\n         */\n        set selected(value) {\n            this.#preselected = value;\n            this.#updateSelected(value);\n        }\n\n        connectedCallback() {\n            super.connectedCallback();\n            this.#dispose = discoverService((commerce) => {\n                const old = [this.#commerce, this.#log, this.#offers];\n                this.#commerce = commerce;\n                this.#log = commerce.Log.module(name);\n                this.#offers = undefined;\n                this.#log.debug('Connected:', { element: this });\n                this.requestUpdate('commerce', old[0]);\n                this.requestUpdate('log', old[1]);\n                this.requestUpdate('offers', old[2]);\n            });\n        }\n\n        disconnectedCallback() {\n            this.#log.debug('Disconnected:', { element: this });\n            super.disconnectedCallback();\n            this.#dispose?.();\n        }\n\n        /**\n         * Override in your component to filter some of discovered commerce offers out of `this.offers`.\n         * By default, includes all offers.\n         * @param {Commerce.Offer} offer\n         * @param {number} index\n         */\n        filterOffer(offer, index) {\n            return true;\n        }\n\n        /**\n         * Override in your component to filter some of discovered commerce placeholders out of `this.offers`.\n         * By default, includes all offers.\n         * @param {Commerce.Placeholder} placeholder\n         * @param {number} index\n         */\n        filterPlaceholder(placeholder, index) {\n            return true;\n        }\n\n        /**\n         * Find all commerce placeholders in the `container` and groups them into offers.\n         * An offer contains lists of checkout link and inline price elements having same plan type.\n         * @param { Element } container\n         */\n        async discoverOffers(container) {\n            this.#control.init();\n            const placeholders = [];\n            const { commerce } = this;\n            if (commerce) {\n                const { CheckoutLink, InlinePrice } = commerce;\n                placeholders.push(\n                    ...CheckoutLink.getCheckoutLinks(container),\n                    ...InlinePrice.getInlinePrices(container)\n                );\n                this.log.debug('Discovering offers:', {\n                    container,\n                    element: this,\n                });\n            }\n            const old = this.#offers;\n            try {\n                const offers = await makeOffers(container, this, placeholders);\n                this.#offers = offers;\n                this.requestUpdate('offers', old);\n                this.#updateSelected(this.#preselected);\n            } catch (error) {\n                this.#control.reject(error);\n            }\n        }\n    };\n}\n", "// NOTE: this component should NOT be used in spectrum-free components like merch-card\n\nimport { LitElement, html } from 'lit';\n\nimport { styles } from './merch-secure-transaction.css.js';\n\nexport const TAG_NAME = 'merch-secure-transaction';\n\nexport default class SecureTransaction extends LitElement {\n    labelText = '';\n    showIcon = true;\n    tooltipText = '';\n\n    get label() {\n        const { labelText, showIcon } = this;\n        // TODO: use `merch-icon` component\n        return html`<div\n            class=\"${showIcon ? 'icon' : ''}\"\n            id=\"label\"\n            slot=\"trigger\"\n        >\n            ${labelText}\n        </div>`;\n    }\n\n    render() {\n        const { tooltipText } = this;\n        if (tooltipText) {\n            return html`\n                <overlay-trigger placement=\"top-start\" offset=\"4\">\n                    ${this.label}\n                    <sp-tooltip id=\"tooltip\" slot=\"hover-content\" delayed\n                        >${tooltipText}</sp-tooltip\n                    >\n                </overlay-trigger>\n            `;\n        }\n        return this.label;\n    }\n\n    static properties = {\n        labelText: { type: String },\n        showIcon: { type: Boolean },\n        tooltipText: { type: String },\n    };\n\n    static styles = [styles];\n}\n\nwindow.customElements.define(TAG_NAME, SecureTransaction);\n", "import { css } from 'lit';\n// TODO: a11y, r12s (responsiveness, if needed)\nimport { DESKTOP_UP, TABLET_UP } from './media.js';\n\nexport const styles = css`\n    #label {\n        align-items: center;\n        cursor: pointer;\n        display: inline-flex;\n        gap: var(--consonant-merch-spacing-xxxs);\n        white-space: nowrap;\n    }\n\n    #label.icon::before {\n        background-position: center;\n        background-size: contain;\n        background: var(--secure-icon) no-repeat;\n        content: '';\n        display: inline-block;\n        height: 1em;\n        width: 1em;\n    }\n`;\n", "// TODO: css variables, a11y, r12s ;)\nimport { css } from 'lit';\n\nexport const styles = css`\n    :host {\n        background-color: #f5f5f5;\n        border-radius: var(--consonant-merch-spacing-xs);\n        display: block;\n        padding: var(--consonant-merch-spacing-xs);\n        max-width: 390px;\n        min-width: 390px;\n    }\n\n    #panel {\n        display: grid;\n        gap: var(--consonant-merch-spacing-xs);\n        grid-template-areas:\n            'header'\n            'offers'\n            'stock'\n            'footer';\n    }\n\n    #header {\n        grid-area: header;\n        order: 1;\n    }\n\n    #footer {\n        justify-content: space-between;\n        display: flex;\n        grid-area: footer;\n        order: 4;\n    }\n\n    #plans {\n        grid-area: offers;\n        order: 2;\n    }\n\n    #spinner {\n        display: flex;\n        justify-content: center;\n    }\n\n    #stock {\n        grid-area: stock;\n        order: 3;\n    }\n\n    input[type='radio'] {\n        height: 0;\n        outline: none;\n        position: absolute;\n        width: 0;\n        z-index: -1;\n    }\n\n    label {\n        background-color: #fff;\n        border-radius: 5px;\n        cursor: pointer;\n        display: block;\n        margin: 16px 0;\n        outline: 0 0 0 1px #eaeaea;\n        padding: 16px;\n        position: relative;\n    }\n\n    input:checked + label {\n        box-shadow: 0 0 0 2px #1473e6;\n    }\n\n    .condition-icon {\n        background-position: center;\n        background-size: contain;\n        background: var(--info-icon) no-repeat;\n        content: '';\n        color: #6e6e6e;\n        display: inline-block;\n        height: 1.1em;\n        margin-bottom: -3px;\n        width: 1.1em;\n    }\n\n    ::slotted([slot$='-commitment']) {\n    }\n\n    ::slotted([slot$='-condition']) {\n        display: inline-block;\n        font-style: italic;\n    }\n\n    ::slotted([slot$='-plan']) {\n        font-weight: 700;\n    }\n`;\n"],
  "mappings": "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",
  "names": ["LitElement", "html", "nothing", "NAMESPACE", "CLASS_NAME_HIDDEN", "EVENT_TYPE_READY", "TAG_NAME_SERVICE", "dispatchAsyncEvent", "target", "type", "bubbles", "cancelable", "composed", "detail", "getCommonAncestor", "elements", "first", "rest", "ancestor", "element", "isRegularPrice", "placeholder", "template", "joinTokens", "tokens", "delimiter", "token", "makeCssClassName", "args", "NAMESPACE", "makeEventTypeName", "showOffers", "offers", "filter", "i", "offer", "CLASS_NAME_HIDDEN", "FAILED", "PENDING", "RESOLVED", "AsyncControl", "#error", "#options", "#state", "#target", "target", "cssPrefix", "eventOptions", "eventPrefix", "options", "state", "makeCssClassName", "makeEventTypeName", "#notify", "detail", "cssClassNames", "eventTypeNames", "dispatchAsyncEvent", "resolve", "reject", "error", "promise", "resolved", "failed", "once", "triggered", "onFailed", "event", "onResolved", "UNKNOWN_PLAN_TYPE", "makeOffers", "container", "filters", "placeholders", "offers", "placeholder", "i", "wcsOffers", "planType", "group", "candidate", "getCommonAncestor", "offer", "discoverService", "callback", "once", "head", "latest", "discover", "current", "TAG_NAME_SERVICE", "EVENT_TYPE_READY", "CommerceAware", "Component", "name", "#control", "AsyncControl", "#commerce", "#dispose", "#log", "#offers", "#preselected", "#selected", "#updateSelected", "value", "selected", "old", "commerce", "index", "CheckoutLink", "InlinePrice", "error", "LitElement", "html", "css", "styles", "css", "TAG_NAME", "SecureTransaction", "LitElement", "labelText", "showIcon", "html", "tooltipText", "styles", "css", "styles", "SLOT_COMMITMENT", "SLOT_CONDITION", "SLOT_CONDITION_TOOLTIP", "SLOT_FOOTER", "SLOT_HEADER", "SLOT_OFFER", "SLOT_STOCK", "OFFER_SLOTS", "REACTIONS", "TAG_NAME", "TAG_NAME_STOCK", "SubscriptionPanel", "CommerceAware", "LitElement", "#active", "#card", "#checkout", "#stock", "#stockSelected", "#updateCheckout", "checkout", "selected", "CLASS_NAME_HIDDEN", "options", "isRegularPrice", "stock", "regularPrice", "#updateSelected", "radio", "showOffers", "offer", "#updateOffers", "offers", "_", "index", "template", "slotName", "#updateSlot", "container", "name", "elements", "clone", "element", "card", "value", "planType", "onInputChange", "html", "nothing", "onStockClick", "old", "onFooterSlotChange", "slot", "changed", "commerce", "log", "key", "args", "styles"]
}
